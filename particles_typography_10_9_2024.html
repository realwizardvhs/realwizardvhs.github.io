<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.2.0/p5.min.js"></script>
    <link rel="stylesheet" href="style.css" type="text/css">
    <meta charset="utf-8">
    <title>Particles</title>
</head>
<body>
    <div class="container">
        <div class="row">
            <div class="col-12">
                <div id="navbar"></div>
            </div>  
        </div>
        <div class="row">
            <div class="col-12 text-center">
                <div id="sketch-holder"></div>
            </div>
        </div>  
        <div class="row">
            <div class="col-12 text-center">
                <h1>Particle Typography</h1>
                <p>10/9/2024</p>
                <p>Move the mouse over the text to interact with the particles</p>
            </div>
        </div>
    </div>
    

    <script src="navbar.js"></script>
    <script>
        let canvas
        let maxShapes;
        let particles = []
        let particleString = "0000"
        let particleStringPoints;
        let font;
        class Particle{
            constructor(x,y,size,c,lifespan){
                this.x = x
                this.y = y
                this.displayX = x
                this.displayY = y
                this.original_size = size
                this.size = size
                this.opacity =1
                this.c = color(
                    hue(c),
                    saturation(c),
                    lightness(c),
                    this.opacity
                )
                this.lifespan = lifespan
            }
            drawshadow(){
                fill('black')
                noStroke();
                ellipse(this.displayX+1.5,this.displayY+1.5,this.size)

            }
            display(){
                this.drawshadow()
                fill(this.c)
                noStroke();
                //ellipse(this.x,this.y,this.size)
                ellipse(this.displayX,this.displayY,this.size)
            }

            update(){
                this.displayX = lerp(this.displayX,this.x,0.05)
                this.displayY = lerp(this.displayY,this.y,0.05)

                this.displayX += random(-2,2)
                this.displayY += random(-2,2)
                this.lifespan -= deltaTime;
                this.size = lerp(this.size,this.original_size,0.5)

                let distanceToMouse = dist(this.x,this.y,mouseX,mouseY)
                let relativeDistance = map(distanceToMouse,0,120,0,5,true)
                relativeDistance = constrain(relativeDistance,0,5)

                let weight = 1-(relativeDistance/5)
               //this.displayX += random(-1,1)*weight
              //  this.displayY += random(-1,1)*weight
               // this.size += random(0,3)*weight
               if(distanceToMouse < 75){
                this.size *= (1.25)
                this.displayX = lerp(this.displayX,mouseX,0.15)
                this.displayY = lerp(this.displayY,mouseY,0.15)

                //this.size *= (random(0.9,1.5)*weight)
               }else{
                this.size += random(-1,1)
                this.size  = lerp(this.size,this.original_size,0.5)
               }
               // let newC = color(hue(this.c),saturation(this.c),lightness(this.c),map(this.lifespan,0,1200,0,1))
                //this.c = newC


                
            }
        }

        let counter = 0
        let time = 0
        
        let texts = [
            "TEST",
            "////",
            "OOOO",
            "[--]",
            "NEAT",
            "WOOP",
            "COOL",
            "BOOP",
            "BEEP",
            "BLOP",
            "ECHO",
            "PING",
            "-][-"
        ]
        function increment(){
            counter++
            if(counter >= texts.length){
                counter = 0
            }
            particleString = texts[counter]
            particleStringPoints = font.textToPoints(particleString,0,height/2 + 300/4,300,
                {
                    sampleFactor: 0.1,
                }
            )
        }

        function preload(){
            font = loadFont('/Inconsolata.otf')
        }

        function setup() {
            canvas = createCanvas(600, 400)
            canvas.parent("sketch-holder")

            colorMode(HSL)


            maxShapes = 100;
            textSize(300)
            textFont(font)
            particleStringPoints = font.textToPoints(particleString,0,height/2 + 300/4,300,
                {
                    sampleFactor: 0.15,
                }
            )



        }

        function draw() {

            drawingContext.shadowColor = ""
            drawingContext.shadowBlur = 0
            drawingContext.shadowOffsetX = 0
            drawingContext.shadowOffsetY = 0
            time += deltaTime
            if(time > 4000){
                increment()
                time = 0
            }
            colorMode(RGB)
            background(255,100)
            colorMode(HSL)
            for(let p of particles){
                p.display()
                p.update()
                if(p.lifespan < 0){
                    particles.splice(particles.indexOf(p),1)
                }
            }

            for(let i=0; i < 8;i++){
                let randomIndex = int(random(particleStringPoints.length))
                let point = particleStringPoints[randomIndex]
                let newParticle = new Particle(
                    point.x,
                    point.y,
                    random(4,20),
                    color(random(360),80,60),random(1000,2000))
                particles.push(newParticle)
            }
        }

    </script>
</body>
</html>