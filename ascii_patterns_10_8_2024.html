<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.2.0/p5.min.js"></script>
    <link rel="stylesheet" href="style.css" type="text/css">
    <meta charset="utf-8">
    <title>Particles</title>
</head>
<body>
    <div class="container">
        <div class="row">
            <div class="col-12">
                <div id="navbar"></div>
            </div>  
        </div>
        <div class="row">
            <div class="col-12 text-center">
                <div id="sketch-holder"></div>
            </div>
        </div>
        <div class="row">
            <div class="col-12 text-center">
                <div id="sketch-controls">
                    <button id="generate" >Generate</button>
                </div>
            </div>
        <div class="row">
            <div class="col-12 text-center">
                <h1>Ascii Patterns</h1>
                <p>10/8/2024</p>
            </div>
        </div>
    </div>
    

    <script src="navbar.js"></script>
    <script>
        let canvas
        let font;

        let grid = []
        let sc;
        let density;
        let _textSize;
        let gapCharacter = " "

        let characterSets = [
            '+-',
            ["--","++"],
            '▒▓█',
            '⟡⟐',
            '⧄⧅⧆⧇⧈',
            '▣▤▥▦▧▨▩',
            ['  ▒','▓  '],
            ['⁂','⁜','※'],
            '⦓⦔',
        ]

        let colors = [
            [[197, 100, 50],[377, 100, 50]],
            [[194, 93, 64],[374, 93, 64]],
            [[221, 86, 65],[417, 86, 65]],
            [[206, 85, 65],[357, 85, 65]],
            [[130, 80,65], [310, 80, 65]],
        ]

        function getRandomColorPair(){
            return colors[Math.floor(random(colors.length))]
        }

        function getRandomCharacterSet(){
            return characterSets[Math.floor(random(characterSets.length))]
        }

        function getRandomString(characterSet){
            if (typeof characterSet == "string"){
                return characterSet.charAt(floor(random(characterSet.length)))
            }else{
                return characterSet[floor(random(characterSet.length))]
            }
        }

        function createGrid(density){
            let characterSet = getRandomCharacterSet()
            let [main, accent] = getRandomColorPair()
            for(let i=0;i<density*density;i++){
                let string = getRandomString(characterSet)
                console.log(string)
                let currentColor = main;
                if(random() > .8){
                    currentColor = accent;
                }
                if(random() > .8){
                    characterSet = getRandomCharacterSet()
                    let [newMain, newAccent] = getRandomColorPair()
                    main = newMain
                    accent = newAccent
                
                }
                let x = (i%density) * width/density
                let y = floor(i/density) * height/density

                grid.push({x,y,string,currentColor,characterSet})
            }
        }
            
        function drawGrid(){
            for(let g of grid){
                fill(g.currentColor[0],g.currentColor[1],g.currentColor[2])
                textSize(_textSize + (width/density-12))
                textAlign(CENTER,CENTER)
                text(g.string,g.x + width/density/2,g.y + height/density/2)
            }
        }

        function setParameters(){
            sc =1// random(0.8,2.5);
            density = floor(random(3,16))
            _textSize = width/(density*2) * sc
        }

        function preload(){
            font = loadFont('/Inconsolata.otf')
        }

        function setup() {
            canvas = createCanvas(600, 600)
            canvas.parent("sketch-holder")
            pixelDensity(1);
            colorMode(HSL)
            setParameters()
            createGrid(10)

            drawingContext.shadowOffsetX = 5
            drawingContext.shadowOffsetY = 5
            drawingContext.shadowBlur = 0
            drawingContext.shadowColor = 'black'

            let generateButton = select("#generate")
            generateButton.mousePressed(generate)
        }

        function generate(){
            grid = []
            setParameters()
            createGrid(10)
        }

        function draw() {
            background(255);
            textFont('monospace')
            drawGrid();

        }

    </script>
</body>
</html>